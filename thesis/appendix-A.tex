\newcommand{\references}[1]{\noindent \textbf{References:} \cref{#1}}

\renewcommand{\tablename}{List}
\setlength{\tabcolsep}{15pt}


\chapter*{Appendix A: Lists of dependencies for reverse shell methods}
\addcontentsline{toc}{chapter}{Appendix A: Lists of dependencies for reverse shell methods}
\markboth{APPENDIX A}{APPENDIX A}

\section*{Programming languages interpreters}

\subsection*{Python}

\references{code:python-script}

List of python modules (\texttt{.py} files or whole directories)\footnote{usually located in \texttt{/usr/lib/python<version>/}}:

\begin{longtable}{l l l l l}
\caption{Python modules used in the Python reverse shell}\label{tab:python-dpd} \\
\texttt{collections} & \texttt{enum} & \texttt{keyword} & \texttt{reprlib} & \texttt{socket} \\
\texttt{encodings} & \texttt{functools} & \texttt{operator} & \texttt{selectors} & \texttt{types} \\
\end{longtable}


\subsection*{PIP}

\references{cmd:pip}

List of python modules (\texttt{.py} files or whole directories)\footnote{usually located in \texttt{/usr/lib/python<version>/}} and loadable objects for some modules\footnote{usually located in \texttt{/usr/lib/python<version>/lib-dynload/}}:

\begin{longtable}{l l}
\caption{Python modules used in the PIP reverse shell}\label{tab:pip-dpd-mod} \\
\texttt{\_\_future\_\_} & \texttt{mimetypes} \\
\texttt{\_compat\_pickle} & \texttt{numbers} \\
\texttt{\_distutils\_hack} & \texttt{opcode} \\
\texttt{\_markupbase} & \texttt{optparse} \\
\texttt{\_sysconfigdata\_\_x86\_64-linux-gnu} & \texttt{pathlib} \\
\texttt{\_weakrefset} & \texttt{pickle} \\
\texttt{argparse} & \texttt{pip} \\
\texttt{ast} & \texttt{pkgutil} \\
\texttt{asyncio} & \texttt{platform} \\
\texttt{base64} & \texttt{plistlib} \\
\texttt{bisect} & \texttt{pprint} \\
\texttt{calendar} & \texttt{py\_compile} \\
\texttt{colorsys} & \texttt{queue} \\
\texttt{compileall} & \texttt{quopri} \\
\texttt{concurrent} & \texttt{random} \\
\texttt{configparser} & \texttt{re} \\
\texttt{contextlib} & \texttt{setuptools} \\
\texttt{contextvars} & \texttt{shlex} \\
\texttt{copyreg} & \texttt{shutil} \\
\texttt{copy} & \texttt{signal} \\
\texttt{csv} & \texttt{socketserver} \\
\texttt{dataclasses} & \texttt{ssl} \\
\texttt{datetime} & \texttt{stringprep} \\
\texttt{decimal} & \texttt{string} \\
\texttt{dis} & \texttt{struct} \\
\texttt{email} & \texttt{subprocess} \\
\texttt{filecmp} & \texttt{sysconfig} \\
\texttt{fnmatch} & \texttt{tarfile} \\
\texttt{fractions} & \texttt{tempfile} \\
\texttt{getopt} & \texttt{textwrap} \\
\texttt{getpass} & \texttt{threading} \\
\texttt{glob} & \texttt{tokenize} \\
\texttt{hashlib} & \texttt{token} \\
\texttt{heapq} & \texttt{traceback} \\
\texttt{hmac} & \texttt{typing} \\
\texttt{html} & \texttt{urllib} \\
\texttt{http} & \texttt{uuid} \\
\texttt{importlib} & \texttt{warnings} \\
\texttt{inspect} & \texttt{weakref} \\
\texttt{ipaddress} & \texttt{wheel} \\
\texttt{json} & \texttt{xmlrpc} \\
\texttt{linecache} & \texttt{xml} \\
\texttt{locale} & \texttt{zipfile} \\
\texttt{logging} & \\
\end{longtable}

\begin{longtable}{l l}
\caption{Loadable objects used in the PIP reverse shell}\label{tab:pip-dpd-so} \\
\texttt{\_contextvars.cpython-312-x86\_64-linux-gnu.so} \\
\texttt{\_decimal.cpython-312-x86\_64-linux-gnu.so} \\
\texttt{mmap.cpython-312-x86\_64-linux-gnu.so} \\
\end{longtable}


\subsection*{Perl}

\references{code:perl-script}

List of Perl modules (\texttt{.pm} files)\footnote{should be located in one of directories from \texttt{@INC} array that \texttt{perl} uses to search for module files}:

\begin{longtable}{l l l l}
\caption{Perl modules used in the Perl reverse shell}\label{tab:perl-dpd} \\
\texttt{Carp} & \texttt{Exporter} & \texttt{strict} & \texttt{warnings} \\
\texttt{Config} & \texttt{Socket} & \texttt{vars} \\
\texttt{DynaLoader} & \texttt{XSLoader} & \texttt{warnings/register} \\
\end{longtable}


\subsection*{Cpan}

\references{cmd:cpan-oneline}

Lists of Perl modules (\texttt{.pm} and \texttt{.pl} files) and loadable objects for some modules \footnote{should be located in one of directories from \texttt{@INC} array that \texttt{perl} uses to search for module files}:

\begin{longtable}{l l}
\caption{Perl modules used in the Cpan reverse shell}\label{tab:cpan-dpd-mod} \\
\texttt{App/Cpan} & \texttt{ExtUtils/MakeMaker/Config} \\
\texttt{B} & \texttt{ExtUtils/MakeMaker/version} \\
\texttt{CPAN/Author} & \texttt{ExtUtils/MakeMaker} \\
\texttt{CPAN/Bundle} & \texttt{Fcntl} \\
\texttt{CPAN/CacheMgr} & \texttt{File/Basename} \\
\texttt{CPAN/Complete} & \texttt{File/Copy} \\
\texttt{CPAN/Debug} & \texttt{File/Find} \\
\texttt{CPAN/DeferredCode} & \texttt{File/Path} \\
\texttt{CPAN/Distribution} & \texttt{File/Path} \\
\texttt{CPAN/Distroprefs} & \texttt{File/Spec/Functions} \\
\texttt{CPAN/Distrostatus} & \texttt{File/Spec/Unix} \\
\texttt{CPAN/Exception/RecursiveDependency} & \texttt{File/Spec} \\
\texttt{CPAN/Exception/yaml\_not\_installed} & \texttt{FileHandle} \\
\texttt{CPAN/Exception/yaml\_process\_error} & \texttt{Getopt/Std} \\
\texttt{CPAN/FTP/netrc} & \texttt{IO/File} \\
\texttt{CPAN/FTP} & \texttt{IO/Handle} \\
\texttt{CPAN/FirstTime} & \texttt{IO/Seekable} \\
\texttt{CPAN/HTTP/Credentials} & \texttt{IO} \\
\texttt{CPAN/HandleConfig} & \texttt{Net/Ping} \\
\texttt{CPAN/Index} & \texttt{Opcode} \\
\texttt{CPAN/InfoObj} & \texttt{POSIX} \\
\texttt{CPAN/LWP/UserAgent} & \texttt{Safe} \\
\texttt{CPAN/Mirrors} & \texttt{Scalar/Util} \\
\texttt{CPAN/Module} & \texttt{SelectSaver} \\
\texttt{CPAN/Prompt} & \texttt{Symbol} \\
\texttt{CPAN/Queue} & \texttt{Sys/Hostname} \\
\texttt{CPAN/Shell} & \texttt{Term/ReadLine} \\
\texttt{CPAN/Tarzip} & \texttt{Text/ParseWords} \\
\texttt{CPAN/URL} & \texttt{Text/Tabs} \\
\texttt{CPAN/Version} & \texttt{Text/Wrap} \\
\texttt{CPAN} & \texttt{Tie/Hash} \\
\texttt{Config\_git} & \texttt{Time/HiRes} \\
\texttt{Config\_heavy} & \texttt{autouse} \\
\texttt{Cwd} & \texttt{builtin} \\
\texttt{DirHandle} & \texttt{constant} \\
\texttt{Errno} & \texttt{if} \\
\texttt{Exporter/Heavy} & \texttt{lib} \\
\texttt{ExtUtils/Liblist/Kid} & \texttt{overloading} \\
\texttt{ExtUtils/Liblist} & \texttt{overload} \\
\texttt{ExtUtils/MM\_Any} & \texttt{re} \\
\texttt{ExtUtils/MM\_Unix} & \texttt{subs} \\
\texttt{ExtUtils/MM} & \texttt{utf8} \\
\texttt{ExtUtils/MY} & \texttt{version} \\
\end{longtable}

\begin{longtable}{l l l}
\caption{Loadable objects used in the Cpan reverse shell}\label{tab:cpan-dpd-so} \\
\texttt{auto/B/B.so} & \texttt{auto/Opcode/Opcode.so} \\
\texttt{auto/Cwd/Cwd.so} & \texttt{auto/POSIX/POSIX.so} \\
\texttt{auto/Fcntl/Fcntl.so} & \texttt{auto/Sys/Hostname/Hostname.so} \\
\texttt{auto/IO/IO.so} & \texttt{auto/re/re.so} \\
\end{longtable}


\subsection*{IRB}

\references{cmd:irb-oneline}

Lists of Ruby modules (\texttt{.rb} files)\footnote{usually located in \texttt{/usr/lib/ruby/<version>/}}, loadable objects for some modules, and special gemspec files \footnote{usually located in \texttt{/usr/lib/ruby/gems/<version>/}}:

\begin{longtable}{l}
\caption{Ruby modules in the IRB reverse shell}\label{tab:irb-dpd-mod} \\
\texttt{delegate} \\
\texttt{fileutils} \\
\texttt{forwardable/impl} \\
\texttt{forwardable} \\
\texttt{irb/color\_printer} \\
\texttt{irb/color} \\
\texttt{irb/completion} \\
\texttt{irb/context} \\
\texttt{irb/easter-egg} \\
\texttt{irb/ext/save-history} \\
\texttt{irb/extend-command} \\
\texttt{irb/init} \\
\texttt{irb/input-method} \\
\texttt{irb/inspector} \\
\texttt{irb/lc/error} \\
\texttt{irb/locale} \\
\texttt{irb/magic-file} \\
\texttt{irb/output-method} \\
\texttt{irb/ruby-lex} \\
\texttt{irb/src\_encoding} \\
\texttt{irb/version} \\
\texttt{irb/workspace} \\
\texttt{irb} \\
\texttt{pp} \\
\texttt{prettyprint} \\
\texttt{reline/ansi} \\
\texttt{reline/config} \\
\texttt{reline/general\_io} \\
\texttt{reline/history} \\
\texttt{reline/key\_actor/base} \\
\texttt{reline/key\_actor/emacs} \\
\texttt{reline/key\_actor/vi\_command} \\
\texttt{reline/key\_actor/vi\_insert} \\
\texttt{reline/key\_actor} \\
\texttt{reline/key\_stroke} \\
\texttt{reline/kill\_ring} \\
\texttt{reline/line\_editor} \\
\texttt{reline/terminfo} \\
\texttt{reline/unicode/east\_asian\_width} \\
\texttt{reline/unicode} \\
\texttt{reline/version} \\
\texttt{reline} \\
\texttt{ripper/core} \\
\texttt{ripper/filter} \\
\texttt{ripper/lexer} \\
\texttt{ripper/sexp} \\
\texttt{ripper} \\
\texttt{rubygems/basic\_specification} \\
\texttt{rubygems/compatibility} \\
\texttt{rubygems/core\_ext/kernel\_gem} \\
\texttt{rubygems/core\_ext/kernel\_require} \\
\texttt{rubygems/defaults} \\
\texttt{rubygems/dependency} \\
\texttt{rubygems/deprecate} \\
\texttt{rubygems/errors} \\
\texttt{rubygems/exceptions} \\
\texttt{rubygems/path\_support} \\
\texttt{rubygems/platform} \\
\texttt{rubygems/request\_set} \\
\texttt{rubygems/request\_set} \\
\texttt{rubygems/requirement} \\
\texttt{rubygems/resolver} \\
\texttt{rubygems/resolver} \\
\texttt{rubygems/source} \\
\texttt{rubygems/specification} \\
\texttt{rubygems/stub\_specification} \\
\texttt{rubygems/text} \\
\texttt{rubygems/tsort/lib/tsort} \\
\texttt{rubygems/tsort} \\
\texttt{rubygems/unknown\_command\_spell\_checker} \\
\texttt{rubygems/util/list} \\
\texttt{rubygems/util} \\
\texttt{rubygems/version} \\
\texttt{rubygems} \\
\texttt{set} \\
\texttt{tempfile} \\
\texttt{timeout} \\
\texttt{tmpdir} \\
\end{longtable}

\begin{longtable}{l l l}
\caption{Loadable objects used in the IRB reverse shell}\label{tab:irb-dpd-so} \\
\texttt{enc/encdb.so} & \texttt{io/wait.so} & \texttt{ripper.so} \\
\texttt{io/console.so} & \texttt{monitor.so} & \texttt{socket.so} \\
\end{longtable}

\begin{longtable}{l}
\caption{Gemspec files used in the IRB reverse shell}\label{tab:irb-dpd-gemspec} \\
\texttt{gems/irb-1.6.2} \\
\texttt{specifications/default/irb-1.6.2.gemspec} \\
\texttt{specifications/default/io-console-0.6.0.gemspec} \\ \texttt{specifications/default/reline-0.3.2.gemspec} \\
\end{longtable}


\subsection*{Node.js}

\references{code:node-script}

Lists of JavaScript modules (\texttt{.js} files)\footnote{usually located in \texttt{/usr/share/nodejs/}}:

\begin{longtable}{l l}
\caption{JavaScript modules used in the Node.js reverse shell}\label{tab:node-dpd} \\
\texttt{/acorn-walk/dist/walk.js} & \texttt{/cjs-module-lexer/lexer.js} \\
\texttt{/acorn/dist/acorn.js} & \texttt{/undici/undici-fetch.js} \\
\texttt{/cjs-module-lexer/dist/lexer.js} & \\
\end{longtable}

\newpage

\section*{Nashorn}

\references{code:nashorn-script}

Additional dynamic libraries \footnote{should be located in \texttt{\$JAVA\_HOME/lib/)} or \texttt{/usr/lib/<architecture>/}}:

\begin{longtable}{l l l}
\caption{Loadable objects used in the Nashorn reverse shell}\label{tab:nashorn-dpd} \\
\texttt{libextnet.so} & \texttt{libm.so.6} \\
\texttt{libgcc\_s.so.1} & \texttt{libnet.so} \\
\texttt{libjava.so} & \texttt{libnio.so} \\
\texttt{libjimage.so} & \texttt{libstdc++.so.6} \\
\texttt{libjli.so} & \texttt{server/libjvm.so} \\
\end{longtable}


\subsection*{Julia}

\references{code:julia-script}

Additional dynamic libraries (apart from those listed with \texttt{ldd})\footnote{should be located in \texttt{/lib/} or \texttt{/lib/julia/}, and inside the \texttt{/snap/} directory when installed with \texttt{snap}}:

\begin{longtable}{l l l}
\caption{Dynamic libraries used in the Julia reverse shell}\label{tab:julia-dpd} \\
\texttt{libLLVM-16jl.so} & \texttt{libmpfr.so.6} \\
\texttt{libatomic.so.1} & \texttt{libopenblas64\_.so} \\
\texttt{libblastrampoline.so.5} & \texttt{libopenlibm.so} \\
\texttt{libgcc\_s.so.1} & \texttt{libpcre2-8.so} \\
\texttt{libgfortran.so.5} & \texttt{libquadmath.so.0} \\
\texttt{libgmp.so.10} & \texttt{librt.so.1} \\
\texttt{libjulia-codegen.so.1.11} & \texttt{libstdc++.so.6} \\
\texttt{libjulia-internal.so.1.11} & \texttt{libunwind.so.8} \\
\texttt{libjulia.so.1.11} & \texttt{libz.so.1} \\
\texttt{libm.so.6} & \texttt{sys.so} \\
\end{longtable}

\newpage

\subsection*{C/C++}

\references{code:c-code}

Additional dynamic libraries (apart from those listed with \texttt{ldd} for \texttt{gcc}, \texttt{as} and \texttt{ld})\footnote{should be located in \texttt{/usr/lib/<architecture>/} or \texttt{/usr/lib/gcc/<architecture>/<gcc-version>/}}:

\begin{longtable}{l l l l}
\caption{Libraries (static and dynamic) used to compile the C/C++ reverse shell code}\label{tab:c-dpd-lib} \\
\texttt{Scrt1.o} & \texttt{libc\_nonshared.a} & \texttt{liblto\_plugin.so} \\
\texttt{crtbeginS.o} & \texttt{libgcc.a} & \texttt{libm.so.6} \\
\texttt{crtendS.o} & \texttt{libgcc\_s.so.1} & \texttt{libmpc.so.3} \\
\texttt{crti.o} & \texttt{libgcc\_s.so} & \texttt{libmpfr.so.6} \\
\texttt{crtn.o} & \texttt{libgmp.so.10} &  \\
\texttt{libc.so} & \texttt{libisl.so.23} &  \\
\end{longtable}


\begin{longtable}{l l l }
\caption{Header files needed to compile the C/C++ reverse shell code}\label{tab:c-dpd-include} \\
\texttt{alloca.h} & \texttt{bits/thread-shared-types.h} \\
\texttt{arpa/inet.h} & \texttt{bits/time64.h} \\
\texttt{asm-generic/bitsperlong.h} & \texttt{bits/timesize.h} \\
\texttt{asm-generic/posix\_types.h} & \texttt{bits/types.h} \\
\texttt{asm-generic/socket.h} & \texttt{bits/types/\_\_sigset\_t.h} \\
\texttt{asm-generic/sockios.h} & \texttt{bits/types/clock\_t.h} \\
\texttt{asm/bitsperlong.h} & \texttt{bits/types/clockid\_t.h} \\
\texttt{asm/posix\_types.h} & \texttt{bits/types/sigset\_t.h} \\
\texttt{asm/posix\_types\_64.h} & \texttt{bits/types/struct\_iovec.h} \\
\texttt{asm/socket.h} & \texttt{bits/types/struct\_osockaddr.h} \\
\texttt{asm/sockios.h} & \texttt{bits/types/struct\_timespec.h} \\
\texttt{bits/atomic\_wide\_counter.h} & \texttt{bits/types/struct\_timeval.h} \\
\texttt{bits/byteswap.h} & \texttt{bits/types/time\_t.h} \\
\texttt{bits/confname.h} & \texttt{bits/types/timer\_t.h} \\
\texttt{bits/endian.h} & \texttt{bits/typesizes.h} \\
\texttt{bits/endianness.h} & \texttt{bits/uintn-identity.h} \\
\texttt{bits/environments.h} & \texttt{bits/unistd\_ext.h} \\
\texttt{bits/floatn-common.h} & \texttt{bits/waitflags.h} \\
\texttt{bits/floatn.h} & \texttt{bits/waitstatus.h} \\
\texttt{bits/getopt\_core.h} & \texttt{bits/wordsize.h} \\
\texttt{bits/getopt\_posix.h} & \texttt{endian.h} \\
\texttt{bits/in.h} & \texttt{features-time64.h} \\
\texttt{bits/libc-header-start.h} & \texttt{features.h} \\
\texttt{bits/long-double.h} & \texttt{gnu/stubs-64.h} \\
\texttt{bits/posix\_opt.h} & \texttt{gnu/stubs.h} \\
\texttt{bits/pthreadtypes-arch.h} & \texttt{linux/posix\_types.h} \\
\texttt{bits/pthreadtypes.h} & \texttt{linux/stddef.h} \\
\texttt{bits/select.h} & \texttt{netinet/in.h} \\
\texttt{bits/sockaddr.h} & \texttt{stdc-predef.h} \\
\texttt{bits/socket.h} & \texttt{stddef.h} \\
\texttt{bits/socket\_type.h} & \texttt{stdlib.h} \\
\texttt{bits/stdint-intn.h} & \texttt{sys/cdefs.h} \\
\texttt{bits/stdint-uintn.h} & \texttt{sys/select.h} \\
\texttt{bits/stdlib-float.h} & \texttt{sys/socket.h} \\
\texttt{bits/struct\_mutex.h} & \texttt{sys/types.h} \\
\texttt{bits/struct\_rwlock.h} & \texttt{unistd.h} \\
\end{longtable}


\subsection*{Java}

Additional dynamic libraries \footnote{should be located in \texttt{\$JAVA\_HOME/lib/} or \texttt{/usr/lib/<architecture>/}}:

\begin{longtable}{l l l}
\caption{Loadable objects used in the Java reverse shell}\label{tab:java-dpd} \\
\texttt{libextnet.so} & \texttt{libm.so.6} \\
\texttt{libgcc\_s.so.1} & \texttt{libnet.so} \\
\texttt{libjava.so} & \texttt{libnio.so} \\
\texttt{libjimage.so} & \texttt{libstdc++.so.6} \\
\texttt{libjli.so} & \texttt{server/libjvm.so} \\
\end{longtable}


\subsection*{Golang}

\references{code:go-code}

Lists of Golang modules (directories containing \texttt{.go} files and also \texttt{.s} and \texttt{.h} files)\footnote{should be located in \texttt{\$GOROOT/src/}}:

\begin{longtable}{l l l }
\caption{Golang modules used to compile and run the Golang reverse shell code}\label{tab:go-dpd} \\
\texttt{bytes} & \texttt{io/fs} \\
\texttt{cmp} & \texttt{io} \\
\texttt{context} & \texttt{math/bits} \\
\texttt{errors} & \texttt{math} \\
\texttt{internal/abi} & \texttt{net/netip} \\
\texttt{internal/bisect} & \texttt{net} \\
\texttt{internal/bytealg} & \texttt{os/exec} \\
\texttt{internal/chacha8rand} & \texttt{os} \\
\texttt{internal/coverage/rtcov} & \texttt{path/filepath} \\
\texttt{internal/cpu} & \texttt{path} \\
\texttt{internal/goarch} & \texttt{runtime/internal/atomic} \\
\texttt{internal/godebugs} & \texttt{runtime/internal/math} \\
\texttt{internal/godebug} & \texttt{runtime/internal/syscall} \\
\texttt{internal/goexperiment} & \texttt{runtime/internal/sys} \\
\texttt{internal/goos} & \texttt{runtime} \\
\texttt{internal/intern} & \texttt{slices} \\
\texttt{internal/itoa} & \texttt{sort} \\
\texttt{internal/nettrace} & \texttt{strconv} \\
\texttt{internal/oserror} & \texttt{strings} \\
\texttt{internal/poll} & \texttt{sync/atomic} \\
\texttt{internal/race} & \texttt{sync} \\
\texttt{internal/reflectlite} & \texttt{syscall} \\
\texttt{internal/safefilepath} & \texttt{time} \\
\texttt{internal/singleflight} & \texttt{unicode/utf8} \\
\texttt{internal/syscall/execenv} & \texttt{unicode} \\
\texttt{internal/syscall/unix} & \texttt{unsafe} \\
\texttt{internal/testlog} & \texttt{vendor} \\
\texttt{internal/unsafeheader} & \\
\end{longtable}
